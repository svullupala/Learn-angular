<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="task _Skins_HTML5_topnav_IBMOEM" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Operations|Hyper-V">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Create a Hyper-V Restore Job Definition</title>
        <link rel="icon" href="../../../Resources/images/IBM-icon-48.ico" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/stylesheets/styles.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/stylesheets/tablet.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/stylesheets/mobile.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.remove-highlight-button
{
	-pie-background: url('../../../../Skins/Default/Stylesheets/Images/highlight.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.expand-all-button
{
	-pie-background: url('../../../../Skins/Default/Stylesheets/Images/expand.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.print-button
{
	-pie-background: url('../../../../Skins/Default/Stylesheets/Images/printer.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.collapse-all-button
{
	-pie-background: url('../../../../Skins/Default/Stylesheets/Images/collapse.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../../resources/stylesheets/styles_topnavi.css" rel="stylesheet" />
        <script src="../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div>
                        <nav class="title-bar tab-bar" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="relative clearfix"><a class="logo" href="../../about/about_application_overview.htm" alt="Logo"></a>
                                    <div class="navigation-wrapper nocontent">
                                        <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="4" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                            <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                            </li>
                                        </ul>
                                    </div>
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="nav-search row outer-row">
                                <form class="search" action="#">
                                    <div class="search-bar search-bar-container needs-pie">
                                        <input class="search-field needs-pie" type="search" placeholder="Search the help system" />
                                        <div class="search-filter-wrapper">
                                            <div class="search-filter">
                                                <div class="search-filter-content">
                                                    <ul>
                                                        <li>All Files</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="search-submit-wrapper" dir="ltr">
                                            <div class="search-submit" title="Search">
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row" data-mc-content-body="True">
                            <div class="buttons popup-container clearfix topicToolbarProxy mc-component nocontent" style="margin-left: 0px; float: right; mc-topic-toolbar-items: RemoveHighlight ExpandAll CollapseAll Print;">
                                <div class="button-group-container-left">
                                    <button class="button needs-pie remove-highlight-button" title="Remove Highlights">
                                        <img src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="remove highlight" />
                                    </button>
                                    <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                        <img src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                    </button>
                                    <button class="button needs-pie print-button" title="Print">
                                        <img src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="print" />
                                    </button>
                                </div>
                            </div>
                            <div class="nocontent">
                                <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                </div>
                            </div>
                            <h1>Create a Hyper-V Restore Job Definition</h1>
                            <p>Hyper-V Restore jobs support Instant VM Restore and Instant Disk Restore scenarios, which are created automatically based on the selected source. </p>
                            <p>If a VHDX is selected for restore, <span class="ProductNames_LongShortECX_Short">IBM Spectrum Protect Plus</span> automatically presents options for an Instant Disk Restore job, which provides instant writable access to data and application restore points. An <span class="ProductNames_LongShortECX_Short">IBM Spectrum Protect Plus</span> snapshot is mapped to a target server where it can be accessed or copied.</p>
                            <p>All other sources are restored through Instant VM&#160;Restore jobs, which can be run in the following modes:</p>
                            <p><b>Test Mode</b> creates temporary virtual machines for development/testing, snapshot verification, and disaster recovery verification on a scheduled, repeatable basis without affecting production environments. Test machines are kept running as long as needed to complete testing and verification and are then cleaned up after testing and verification completes. Through fenced networking, you can establish a safe environment to test your jobs without interfering with virtual machines used for production. Virtual machines created through Test mode are also given unique names and identifiers to avoid conflicts within your production environment.</p>
                            <p><b>Clone Mode</b> creates copies of virtual machines for use cases requiring permanent or long-running copies for data mining or duplication of a test environment in a fenced network. Virtual machines created through Clone mode are also given unique names and identifiers to avoid conflicts within your production environment. With clone mode you must be sensitive to resource consumption, since clone mode creates permanent or long-term virtual machines.</p>
                            <p><b>Production Mode</b> enables disaster recovery at the local site from primary storage or a remote disaster recovery site, replacing original machine images with restore images. All configurations are carried over as part of the recovery, including names and identifiers, and all copy data jobs associated with the virtual machine continue to run.</p>
                            <p><span class="NoteBlue">Note:</span> Moving from Test Mode to Production Mode is not supported for Hyper-V.</p>
                            <div class="Prerequisite">
                                <p class="PostPreRelTitleLeft"><span class="PostPreRelTitle"> BEFORE&#160;YOU&#160;BEGIN:</span>
                                </p>
                                <ul>
                                    <li value="1">Create and run a Hyper-V Backup job. See <a href="hyperv_backup.htm" class="MCXref xref">Create a Hyper-V Backup Job Definition</a>.</li>
                                    <li value="2">Hyper-V Backup and Restore jobs require the installation of the latest Hyper-V integration services. For Microsoft Windows environments, see <a href="https://docs.microsoft.com/en-us/windows-server/virtualization/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows" target="_blank">https://docs.microsoft.com/en-us/windows-server/virtualization/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows</a>. For Linux environments, see <a href="https://docs.microsoft.com/en-us/windows-server/virtualization/hyper-v/supported-linux-and-freebsd-virtual-machines-for-hyper-v-on-windows" target="_blank">https://docs.microsoft.com/en-us/windows-server/virtualization/hyper-v/supported-linux-and-freebsd-virtual-machines-for-hyper-v-on-windows</a>.</li>
                                    <li value="3"> Before an <span class="ProductNames_LongShortECX_Short">IBM Spectrum Protect Plus</span> user can perform backup and restore operations, roles and resource groups must be assigned to the user. Grant users access to resources and backup and restore operations through the <b data-mc-conditions="Default.1012 navigation">Accounts</b> pane. See <a href="../../access/access_overview.htm" class="MCXref xref">Access</a>.</li>
                                </ul>
                                <p class="PostPreRelTitleLeft"><span class="PostPreRelTitle"> CONSIDERATIONS:</span>
                                </p>
                                <ul>
                                    <li value="1">When selecting a destination for a Restore job definition, note that the destination must be registered in <span class="ProductNames_LongShortECX_Short">IBM Spectrum Protect Plus</span>. This includes Restore jobs that restore data to original hosts or clusters. </li>
                                </ul>
                            </div>
                            <p class="ListHeading">To create a Hyper-V Restore job definition:</p>
                            <ol>
                                <li value="1" data-mc-conditions="Default.1012 navigation">From the navigation menu, expand <b>Manage Protection</b>, then expand <b>Hypervisors</b>. Expand <b>Hyper-V</b>, then click <b>Restore</b>.</li>
                                <li value="2">In the Restore pane, review the available restore points of your Hyper-V sources,  including virtual machines, VM templates, datastores, folders, and vApps. Use the search function and filters to fine-tune your selection across specific recovery site types. Expand an entry in the Restore pane to view individual restore points by date.</li>
                                <li value="3" data-mc-conditions="Default.1012 navigation">To select the latest restore point, click <span class="Strong">Add to Restore List</span> <img src="../../../resources/images/new_icons/add_to_restorelist.png" style="vertical-align: text-top;border-left-style: solid;border-left-width: 0px;border-left-color: #000000;border-right-style: solid;border-right-width: 0px;border-right-color: #000000;border-top-style: solid;border-top-width: 0px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 0px;border-bottom-color: #000000;" alt="Add to Restore List icon" />  at the resource level. Then, from the <b>Select a site</b> drop-down menu, select the site associated with the backup storage server you want to recover from. To restore a specific restore point from a specific site, expand a resource in the Restore pane, then click the <span class="Strong">Add to Restore List</span> <img src="../../../resources/images/new_icons/add_to_restorelist.png" style="vertical-align: text-top;border-left-style: solid;border-left-width: 0px;border-left-color: #000000;border-right-style: solid;border-right-width: 0px;border-right-color: #000000;border-top-style: solid;border-top-width: 0px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 0px;border-bottom-color: #000000;" alt="Add to Restore List icon" />  icon associated with the restore point. Note that adding a combination of latest restore points and specific restore points to the Restore List is not supported. Click the <span class="Strong">Remove</span> <img src="../../../resources/images/new_icons/remove.png" style="vertical-align: text-top;border-left-style: solid;border-left-width: 0px;border-left-color: #000000;border-right-style: solid;border-right-width: 0px;border-right-color: #000000;border-top-style: solid;border-top-width: 0px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 0px;border-bottom-color: #000000;" alt="Remove icon" />  icon to remove restore points from the Restore List.</li>
                                <li value="4">To run the job now using default options, click <b>Restore</b>. To schedule the job to run using default options, click <b>Manage Job</b><b>s</b> and define a trigger for the job definition. </li>
                                <li value="5">To edit  options before creating the job definition, click <b>Options</b>. Set the job definition options. </li>
                                <li class="indent" style="font-weight: bold;" data-mc-autonum=""><span class="autonumber"><span></span></span>Destination</li>
                                <li class="Indent_Level2" data-mc-autonum=""><span class="autonumber"><span></span></span>Set the Hyper-V destination. </li>
                                <li class="Indent_Level2" data-mc-autonum=""><span class="autonumber"><span></span></span><b>Original&#160;Hyper-V Host or Cluster</b> - Select to restore to the original host or cluster.</li>
                                <li class="Indent_Level2" data-mc-autonum=""><span class="autonumber"><span></span></span><b>Alternate Hyper-V Host or Cluster</b> - Select to restore to a local destination different from the original host or cluster, then select the alternate location from available resources.</li>
                                <li class="indent" style="font-weight: bold;" data-mc-autonum=""><span class="autonumber"><span></span></span>Restore Type</li>
                                <li class="Indent_Level2" data-mc-autonum=""><span class="autonumber"><span></span></span>Set the Hyper-V Restore job to run in Test, Production, or Clone mode by default. Once the job is created, it can be run in Test, Production, or Clone mode through the Job Sessions pane. </li>
                                <li class="indent" style="font-weight: bold;" data-mc-autonum=""><span class="autonumber"><span></span></span>Network Settings</li>
                                <li class="Indent_Level2" data-mc-autonum=""><span class="autonumber"><span></span></span>Set the network settings for a restore to an alternate Hyper-V&#160;host or cluster:</li>
                                <li class="Indent_Level2" data-mc-autonum=""><span class="autonumber"><span></span></span>From the <b>Production</b> and <b>Test</b> fields, set virtual networks for production and test restore job runs. Destination network settings for production and test environments should be different locations to create a fenced network, which keeps virtual machines used for testing from interfering with virtual machines used for production. The networks associated with Test and Production will be utilized when the restore job is run in the associated mode. </li>
                                <li class="Indent_Level2" data-mc-autonum=""><span class="autonumber"><span></span></span>Set an IP address or subnet mask for virtual machines to be re-purposed for development/testing or disaster recovery use cases. Supported mapping types include IP to IP, IP to DHCP, and subnet to subnet. Virtual machines containing multiple NICs are supported.</li>
                                <li class="indent" style="font-weight: bold;" data-mc-autonum=""><span class="autonumber"><span></span></span>Destination Datastore</li>
                                <li class="Indent_Level2" data-mc-autonum=""><span class="autonumber"><span></span></span>Set the destination datastore for a restore to an alternate  Hyper-V&#160;host or cluster.</li>
                                <li class="indent_strong" data-mc-autonum=""><span class="autonumber"><span></span></span>Pre-scripts and Post-Scripts</li>
                                <li class="Indent_Level2" data-mc-autonum=""><span class="autonumber"><span></span></span>In the Pre-Script and/or Post-Script section, select an uploaded script and a script server where the script will run. Scripts and script servers are configured through the <b data-mc-conditions="Default.1012 navigation">Jobs and Monitoring &gt;&#160;Script</b> pane. See <a href="../../system/system_script.htm" class="MCXref xref">Configure Scripts</a>.</li>
                                <li class="Indent_Level2" data-mc-autonum=""><span class="autonumber"><span></span></span>Pre-scripts and post-scripts are scripts that can be run before or after a job runs at the job-level. Windows-based machines support Batch and PowerShell scripts while Linux-based machines support shell scripts. </li>
                                <li class="Indent_Level2" data-mc-autonum=""><span class="autonumber"><span></span></span><b data-mc-conditions="Default.1012 navigation">Continue job/task on script error</b> - When enabled, if a Pre-script completes with a non-zero return code, the backup or restore is attempted and the Pre-script task status returns COMPLETED. When disabled, the backup or restore is not attempted, and the Pre-script task status returns FAILED.  If a Post-script completes with a non-zero return code, the Post-script task status returns COMPLETED. When disabled, the Post-script task status returns FAILED.</li>
                                <li class="indent" style="font-weight: bold;" data-mc-autonum=""><span class="autonumber"><span></span></span>Advanced Options</li>
                                <li class="Indent_Level2" data-mc-autonum=""><span class="autonumber"><span></span></span>Set the advanced job definition options:</li>
                                <li class="Indent_Level2" data-mc-autonum=""><span class="autonumber"><span></span></span><b>Power on after recovery</b> - Toggle the power state of a virtual machine after a recovery is performed. Virtual machines are powered on in the order they are recovered, as set in the Source step. Note that restored VM templates cannot be powered on after recovery.</li>
                                <li class="Indent_Level2" data-mc-autonum=""><span class="autonumber"><span></span></span><b>Overwrite virtual machine</b> - Enable to allow the restore job to overwrite the selected virtual machine. By default this option is disabled.</li>
                                <li class="Indent_Level2" data-mc-autonum=""><span class="autonumber"><span></span></span><b>Continue with restore even if it fails</b> - Toggle the recovery of a resource in a series if the previous resource recovery fails. If disabled, the Restore job stops if the recovery of a resource fails.</li>
                                <li class="Indent_Level2" data-mc-autonum=""><span class="autonumber"><span></span></span><b data-mc-conditions="Default.1012 navigation">Run cleanup immediately on job failure</b> - Enable to automatically clean up allocated resources as part of a restore if the virtual machine recovery fails.</li>
                                <li class="Indent_Level2" data-mc-autonum=""><span class="autonumber"><span></span></span><b>Allow to overwrite and force clean up of pending old sessions</b> - Enable this option to allow a scheduled session of a recovery job to force an existing pending session to clean up associated resources so the new session can run. Disable this option to keep an existing test environment running without being cleaned up.</li>
                                <li class="indent" data-mc-autonum=""><span class="autonumber"><span></span></span>Click <b>Save</b> to save the policy options. </li>
                                <li value="6">To run the job now, click <b>Restore</b>. To schedule the job click <b>Manage Job</b><b>s</b> and define a trigger for the job definition. </li>
                                <li value="7">Once the job completes successfully, select one of the following options from the <span class="Strong">Actions</span> menu on the Jobs Sessions or Active Clones sections on the Restore pane:&#160;</li>
                                <li class="indent" data-mc-autonum=""><span class="autonumber"><span></span></span><b>Cleanup</b> destroys the virtual machine and cleans up all associated resources. Since this is a temporary/testing virtual machine, all data is lost when the virtual machine is destroyed.</li>
                                <li class="indent" data-mc-autonum=""><span class="autonumber"><span></span></span><b>Clone (migrate)</b> migrates the virtual machine to the Datastore and Virtual Network defined as the "Test" network.</li>
                            </ol>
                            <div class="RelatedTopic">
                                <p class="PostPreRelTitleLeft"><span class="PostPreRelTitle">RELATED TOPICS:</span>
                                </p>
                                <ul>
                                    <li value="1"><a href="hyperv_backup.htm" class="MCXref xref">Create a Hyper-V Backup Job Definition</a>
                                    </li>
                                    <li value="2"><a href="hyperv_manage.htm" class="MCXref xref">Add a Hyper-V Provider</a>
                                    </li>
                                </ul>
                            </div>
                            <p>&#160;</p>
                            <hr width="100%" size="0" align="center" />
                            <p style="text-align: left;"><span class="Strong" style="font-size: 10pt;">IBM Spectrum Protect Plus</span> <span class="Strong" style="font-size: 10pt;">10.1.2</span> <![CDATA[ ]]></p>
                            <p style="font-size: 8pt;">Licensed Material - Property of IBM Corp. © IBM Corporation and other(s) <span class="GeneralYear">2018</span>. IBM is a registered trademark of the IBM Corporation in the United States, other countries, or both. <span style="font-size: 10pt;"><span style="font-size: 8pt;">| </span></span><span style="font-size: 8pt;" class="SystemShortDate">8/23/2018</span></p>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>